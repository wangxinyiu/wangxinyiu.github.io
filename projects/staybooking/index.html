<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #FF4D4D;
        }
    </style>

    
    
    
    
    
    

    
    <title>StayBooking - An online stay rental application</title>
    <meta name="description" content="Hello and welcome to my portfolio!">
    <meta name="keywords" content='blog, gokarna, hugo'>

    <meta property="og:url" content="https://wangxinyiu.github.io/projects/staybooking/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="StayBooking - An online stay rental application">
    <meta property="og:description" content="Hello and welcome to my portfolio!">
    <meta property="og:image" content="https://wangxinyiu.github.io/images/uci_1.jpg">
    <meta property="og:image:secure_url" content="https://wangxinyiu.github.io/images/uci_1.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="StayBooking - An online stay rental application">
    <meta name="twitter:description" content="Hello and welcome to my portfolio!">
    <meta property="twitter:domain" content="https://wangxinyiu.github.io/projects/staybooking/">
    <meta property="twitter:url" content="https://wangxinyiu.github.io/projects/staybooking/">
    <meta name="twitter:image" content="https://wangxinyiu.github.io/images/uci_1.jpg">

    
    <link rel="canonical" href="https://wangxinyiu.github.io/projects/staybooking/" />

    
    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print">

    
    <link rel="stylesheet" type="text/css" href="/css/main.min.css">

    
    <link id="dark-theme" rel="stylesheet" href="/css/dark.min.css">

    
    <script src="/js/bundle.min.c60dbb422ed053b0761160e3a3f08b9af2060f00adc8f12c0ff21a8cf55b3d8e.js" integrity="sha256-xg27Qi7QU7B2EWDjo/CLmvIGDwCtyPEsD/IajPVbPY4="></script>

    
    

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'forest'
        });
    </script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js" integrity="sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
          ],
          // • rendering keys, e.g.:
          throwOnError : false
        });
      });
    </script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://wangxinyiu.github.io/">
                <img src='/images/uci_1.jpg' alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://wangxinyiu.github.io/">Xinyi Wang</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://wangxinyiu.github.io/"><span data-feather='home'></span> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://wangxinyiu.github.io/experience/"><span data-feather='book'></span> Experience </a>
            </div>
            
            <div class="nav-link">
                <a href="https://wangxinyiu.github.io/projects/"><span data-feather='code'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://wangxinyiu.github.io/posts/"><span data-feather='coffee'></span> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://wangxinyiu.github.io/index.xml"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://wangxinyiu.github.io/"><span data-feather='home'></span> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://wangxinyiu.github.io/experience/"><span data-feather='book'></span> Experience </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://wangxinyiu.github.io/projects/"><span data-feather='code'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://wangxinyiu.github.io/posts/"><span data-feather='coffee'></span> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://wangxinyiu.github.io/index.xml"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    

    <div class="post container">

    <div class="post-header-section">
        <h1>StayBooking - An online stay rental application</h1>
    </div>

    <div class="post-content">
        <p>
            <ul>
<li><a href="#what-i-did">What I did</a></li>
<li><a href="#backend-structure">Backend Structure</a></li>
<li><a href="#data-model">Data Model</a></li>
<li><a href="#compelete-code">Compelete Code</a></li>
<li><a href="#challenge">Challenge</a>
<ul>
<li><a href="#elastic-searchstar">Elastic Search(Star)</a>
<ul>
<li><a href="#elastic-search-%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4%E7%AE%80%E8%BF%B0">elastic search 实现步骤简述</a></li>
<li><a href="#%E7%94%A8google-cloud-storagegcs%E5%AD%98%E5%82%A8%E7%85%A7%E7%89%87%E7%AD%89%E6%B5%81%E5%AA%92%E4%BD%93">用Google cloud storage（GCS）存储照片等流媒体</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88elastic-search%E7%9A%84%E5%85%A8%E5%B1%80%E6%90%9C%E7%B4%A2%E8%83%BD%E5%8A%9B%E8%BF%99%E4%B9%88%E5%BC%BA%E5%91%A2">为什么elastic search的全局搜索能力这么强呢？</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="what-i-did">What I did</h2>
<p><strong>Deomo: <a href="https://recordit.co/cXdWcj0ahV">https://recordit.co/cXdWcj0ahV</a></strong></p>
<ul>
<li>Designed and built a single-page web application using <strong>React</strong>. Bootstrap the development with mature component library <strong>Ant Design</strong>.</li>
<li>Implemented the backend services based on <strong>Spring Boot</strong> to support stay upload, delete, search, and reserve functionality.</li>
<li>Used <strong>MySQL</strong> to store user-generated data, e.g. stay information and reservation history, and utilized <strong>Google Cloud Storage</strong> to store media files for uploaded stays.</li>
<li>Created <strong>geo index</strong> by <strong>Elasticsearch</strong> to support geo-based stay search based on user’s selected locations.</li>
<li>Implemented <strong>token-based</strong> server-side user authentication based on the <strong>Spring Security framework</strong>.</li>
<li>Deployed the backend service to <strong>Google App Engine</strong> for better scalability and reliability.</li>
</ul>
<h2 id="backend-structure">Backend Structure</h2>
<p><img src="/images/staybooking1.jpg" alt="backend_structure"></p>
<h2 id="data-model">Data Model</h2>
<p><img src="/images/staybooking2.png" alt="backend_structure"></p>
<h2 id="compelete-code">Compelete Code</h2>
<p><a href="https://github.com/wangxinyiu/staybooking">https://github.com/wangxinyiu/staybooking</a></p>
<h2 id="challenge">Challenge</h2>
<h3 id="elastic-searchstar">Elastic Search(Star)</h3>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Situation（情境）</strong>：开发一个类似于Airbnb的在线住宿分享和搜索平台。(Develop an Airbnb-like online accommodation sharing and search platform.)</p>
<p><strong>Task（任务）</strong>：需要选择合适的数据库来存储包括照片、地理位置、住宿名称在内的信息，并实现基于地理位置的住宿搜索功能。(There is a need to select a suitable database to store information including photos, geographic locations, accommodation names, and to implement a location-based accommodation search function.)</p>
<p><strong>Action（行动）</strong>：选择使用Google Cloud Storage来存储照片等媒体文件，利用Elasticsearch来创建地理索引并实现基于地理位置的高效搜索。(Choose to use Google Cloud Storage to store media files such as photos, and Elasticsearch to create geo-indexing and enable efficient location-based search.)</p>
<blockquote>
<p>在选择技术栈的过程中，特别是面对存储媒体文件和实现基于地理位置的搜索功能的需求时，我进行了以下考虑和分析：</p>
</blockquote>
<blockquote>
<p><strong>对媒体文件存储的考虑</strong>：</p>
<ol>
<li>容量和扩展性：考虑到用户上传的照片和视频可能会占用大量的存储空间，并且随着平台用户数量的增加，这些需求只会增加，我需要一个能够轻松扩展的存储解决方案。</li>
<li>数据访问速度和全球可达性：为了提供良好的用户体验，确保全球用户都能快速访问这些媒体文件是非常重要的。</li>
<li>成本效率：存储成本是另一个重要考量，特别是对于刚起步的项目，找到一个成本效率高的解决方案至关重要。</li>
</ol>
</blockquote>
<blockquote>
<p><strong>对地理位置搜索的考虑</strong>：</p>
<ol>
<li>复杂查询的支持：除了地理位置外，用户可能还会基于价格、设施等其他条件进行搜索，所以需要一个能够支持复杂查询的系统。</li>
<li>实时性：新上线的住宿信息需要能够尽快被索引并加入搜索结果中，以提供最新的数据给用户。</li>
</ol>
</blockquote>
<p><strong>Result（结果）</strong>：通过结合Google Cloud Storage和Elasticsearch，项目能够有效地存储用户上传的信息并支持快速的地理位置搜索，满足用户对于查找附近住宿的需求。(By combining Google Cloud Storage and Elasticsearch, the project is able to efficiently store user uploads and support fast geo-location searches to fulfill users&rsquo; needs for finding nearby accommodations.)</p>
<h4 id="elastic-search-实现步骤简述">elastic search 实现步骤简述</h4>
<p>使用MySQL存储主要的业务数据，利用其成熟的事务处理和复杂查询能力；同时，使用Elasticsearch来处理地理位置搜索和全文搜索需求，利用其快速的搜索能力和对地理空间数据的良好支持。</p>
<ol>
<li>
<p><strong>数据存储</strong>：将用户信息、住宿信息等业务数据存储在MySQL数据库中。这些信息包括用户的注册信息、住宿的描述、价格、设施信息等。</p>
</li>
<li>
<p><strong>同步数据到Elasticsearch</strong>：选择需要支持快速搜索的数据（如住宿信息）同步到Elasticsearch。这可以通过定期的批处理作业完成，或者使用像Logstash这样的数据管道工具实时同步。确保每条住宿记录中包括地理位置信息（例如，经纬度）。</p>
</li>
<li>
<p><strong>创建地理空间索引</strong>：在Elasticsearch中针对住宿信息创建地理空间索引。使用Elasticsearch的地理空间特性（如geo_point类型字段）来存储和索引住宿的地理位置。</p>
</li>
<li>
<p><strong>基于地理位置的搜索</strong>：当用户通过界面选择一个位置进行住宿搜索时，后端服务将构造一个Elasticsearch查询，该查询基于用户指定的地理位置和其他可能的筛选条件（如价格范围、设施要求等）进行搜索。Elasticsearch会根据地理索引快速返回相关的住宿选项。</p>
</li>
<li>
<p><strong>展示结果</strong>：后端服务从Elasticsearch获取搜索结果后，可能需要再次查询MySQL数据库以获取完整的住宿信息（如果Elasticsearch中没有存储全部数据）。最后，将这些信息展示给用户。</p>
</li>
</ol>
<p><strong>注意事项</strong></p>
<ul>
<li>
<p><strong>数据一致性</strong>：保持MySQL和Elasticsearch之间数据的一致性是重要的。需要确保当MySQL中的数据发生变化时，相应的变化也同步到Elasticsearch。</p>
</li>
<li>
<p><strong>性能与成本</strong>：虽然Elasticsearch提供了强大的搜索能力，但其运行和维护也会带来额外的成本和复杂性。权衡性能需求和成本是选择使用Elasticsearch的一个重要考虑因素。</p>
</li>
</ul>
<h4 id="用google-cloud-storagegcs存储照片等流媒体">用Google cloud storage（GCS）存储照片等流媒体</h4>
<p>使用了SQL数据库与Google Cloud Storage（GCS）结合的，在SQL数据库中存储一个指向GCS中存储资源（如照片、视频等媒体文件）的链接（URL）。</p>
<p><strong>工作流程</strong></p>
<ol>
<li>
<p>上传文件到GCS：当用户上传照片或其他媒体文件时，这些文件被上传到GCS的一个特定的桶（Bucket）中。每个文件上传后，GCS会提供一个唯一的URL，用于访问或引用这个文件。</p>
</li>
<li>
<p>存储链接到SQL数据库：在SQL数据库的相应记录中，你会存储指向GCS中文件的URL。例如，如果你的数据库中有一个accommodations表格用于存储住宿信息，它可能包括name（名称）、location（地理位置）等字段，以及一个photo_url字段，后者存储的就是指向GCS中相应照片的URL。</p>
</li>
<li>
<p>数据检索：当需要展示住宿信息（包括照片）给用户时，应用后端会从SQL数据库中查询住宿记录，获取照片的URL，并在前端页面中通过这个URL从GCS加载照片。</p>
</li>
</ol>
<p><strong>为什么用GCS？</strong></p>
<ul>
<li>分离存储：通过将大型的媒体文件存储在GCS中，可以避免SQL数据库因管理大量大型二进制对象（BLOBs）而变得臃肿，有助于提高数据库的性能和管理效率。</li>
<li>可扩展性和可靠性：GCS提供了高度的可扩展性和数据持久性，能够有效地存储和管理大量的媒体文件，同时还支持全球访问和高可用性。</li>
<li>安全性和权限控制：GCS提供了细粒度的权限控制，你可以配置谁可以访问或修改存储的文件，增强了数据的安全性。</li>
</ul>
<h4 id="为什么elastic-search的全局搜索能力这么强呢">为什么elastic search的全局搜索能力这么强呢？</h4>
<ol>
<li>
<p><strong>倒排索引</strong>：Elasticsearch使用倒排索引来实现其搜索功能。倒排索引是一种索引，其中每个唯一的单词都有一个包含该单词的所有文档列表。这种结构使得对任意词的搜索变得非常快速，因为搜索引擎可以直接定位到包含搜索词的文档，而不需要遍历所有文档。</p>
</li>
<li>
<p><strong>分布式架构</strong>：Elasticsearch天生支持分布式，数据可以跨多个节点分散存储。这种架构不仅提高了系统的可用性和容错能力，还允许Elasticsearch并行处理大量数据，显著提高搜索速度和处理能力。</p>
</li>
<li>
<p><strong>高效的数据结构</strong>：Elasticsearch内部使用高效的数据结构和算法，比如压缩的倒排索引、缓存机制等，进一步提升了搜索的速度和准确性。</p>
</li>
<li>
<p><strong>灵活的查询语言</strong>：Elasticsearch提供了一种丰富而灵活的查询DSL（领域特定语言），支持各种类型的搜索，包括简单的文本匹配、复杂的布尔操作、过滤、排序、聚合等。这使得开发者可以构建复杂且精确的查询来满足各种搜索需求。</p>
</li>
<li>
<p><strong>实时搜索</strong>：Elasticsearch几乎可以实现实时搜索。当文档被索引到Elasticsearch后，它几乎立即就可以被搜索到，这对于需要快速响应用户查询的应用场景非常重要。</p>
</li>
<li>
<p><strong>自然语言处理功能</strong>：Elasticsearch支持文本分析和自然语言处理功能，如分词、同义词处理、拼写纠正等。这些功能使得Elasticsearch能够理解和处理人类语言，提供更为相关和准确的搜索结果。</p>
</li>
<li>
<p><strong>易于扩展和维护</strong>：Elasticsearch的设计使其易于扩展和维护。你可以简单地通过添加节点来扩展集群，以处理更多数据和查询，而不需要对现有应用程序进行大的修改。</p>
</li>
</ol>

        </p>
    </div>


        
        
        <svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top">
            
            <path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/>
        </svg>
        
        <script>
            let backToTopButton = document.getElementById("btt-button");
    
            window.onscroll = function() {
                scrollFunction()
            };
    
            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    backToTopButton.style.display = "block";
                } else {
                    backToTopButton.style.display = "none";
                }
            }
    
            function topFunction() {
                
                document.body.scrollTop = 0; 
                document.documentElement.scrollTop = 0; 
            }
    
            function smoothScrollToTop() {
                const scrollToTop = () => {
                    const c = document.documentElement.scrollTop || document.body.scrollTop;
                    if (c > 0) {
                        window.requestAnimationFrame(scrollToTop);
                        window.scrollTo(0, c - c / 8);
                    }
                };
                scrollToTop();
            }
        </script>
        
</div>




        </main><footer class="footer">
    
    

    
    <span>&copy; 2021-2024</span>
    
    
    
</footer>
</body>
</html>
